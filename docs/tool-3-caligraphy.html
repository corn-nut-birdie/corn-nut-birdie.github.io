<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta content="webkit" name="renderer"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta content="width=device-width,initial-scale=1" name="viewport"/>

    <title>Calligraphy</title>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css" rel="stylesheet">
    <link href="https://unpkg.com/normalize.css@8.0.1/normalize.css" rel="stylesheet">

    <style>
        [v-cloak] {
            display: none;
        }

        .char-container {
            margin: 8px 12px;
            font-size: 120px;
            display: inline-block;
        }

        .char {
            margin: 2px;
            width: 1.06em;
            height: 1.06em;
            line-height: 1;
            box-sizing: content-box;
            border: lightseagreen 3px solid;
            display: inline-flex;
            align-content: center;
            justify-content: center;
            vertical-align: middle;
            font-family: "Brush Script MT", "Comic Sans MS", cursive;
            color: indianred;
            background-color: greenyellow;
            background-image: repeating-linear-gradient(to right, slategrey, slategrey 9px, transparent 9px, transparent 15px),
            repeating-linear-gradient(to bottom, slategrey, slategrey 9px, transparent 9px, transparent 15px),
            linear-gradient(to right bottom, transparent calc(50% - 1px / 1.8), grey calc(50% - 1px / 1.8), grey calc(50% + 1px / 1.8), transparent calc(50% + 1px / 1.8)),
            linear-gradient(to right top, transparent calc(50% - 1px / 1.8), grey calc(50% - 1px / 1.8), grey calc(50% + 1px / 1.8), transparent calc(50% + 1px / 1.8));
            background-size: auto 1px, 1px auto, auto, auto;
            background-repeat: no-repeat;
            background-position: center;
            -webkit-background-clip: content-box;
        }
    </style>

    <script>
        const {loadedHandler, loadedPromise} = (() => {
            let vueR;
            const vuePromise = Promise.all([
                new Promise(r => {
                    vueR = r;
                }),
            ]);

            return {
                loadedHandler:
                    src => {
                        switch (src) {
                            case 'vue':
                                vueR();
                                break;
                        }
                    },
                loadedPromise: vuePromise
            };
        })();
    </script>

    <script async onload="loadedHandler('vue')"
            src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.2.45/vue.global.min.js"></script>
    <script async onload="loadedHandler('vue')"
            src="https://cdn.jsdelivr.net/npm/vue@3.2.45/dist/vue.global.js"></script>
    <script async onload="loadedHandler('vue')"
            src="https://unpkg.com/vue@3.2.45/dist/vue.global.js"></script>

    <template id="main">
        <div>
            <label style="margin: 16px 16px 0;display: block;">
                <span style="margin-bottom: 8px;display: block;">输入文字</span>
                <textarea placeholder="输入文字" v-model="chars"
                          style="width: calc(100% - 28px);height: 128px;"></textarea>
            </label>
        </div>

        <div class="char-container">
            <template v-for="c in stripped">
                <br v-if="c === '\n'">
                <span class="char" v-else>{{c}}</span>
            </template>
        </div>
    </template>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            console.log('stage 1')
            loadedPromise.then(() => {
                Vue.createApp({
                    template: document.getElementById('main'),
                    data() {
                        return {
                            chars: '山木啸兮云幽幽，秣我归马兮无为久留。',
                        }
                    },
                    computed: {
                        stripped() {
                            return this.chars.trim().replaceAll(/(?<=\n)\s+(?=\n)/g, '').replaceAll(/\n{2,}/g, '\n');
                        }
                    }
                }).mount('#app');
            });
        });
    </script>
</head>
<body>
<div id="app"></div>

</body>
</html>
