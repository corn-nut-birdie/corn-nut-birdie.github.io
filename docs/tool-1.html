<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta content="webkit" name="renderer"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta content="width=device-width,initial-scale=1" name="viewport"/>
    <meta content="工具页面-词典" name="description"/>
    <title>工具页面-词典</title>
    <style>
        .container {
            margin: 16px 12px 0;
        }

        .dict-form {
            max-width: 420px;
            margin: 0 auto;
        }

        .dict-input-line {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 8px;
        }

        .dict-input-box {
            display: flex;
            align-items: center;
            flex: 1 1;
        }

        .dict-input-label-text {
            white-space: nowrap;
        }

        .dict-input-field {
            margin: 0 8px;
            flex: 1 1;
        }

        .dict-query-button {
            flex-shrink: 0;
        }

        .dict-sites-line {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
        }

        .dict-sites-label-text {
            white-space: nowrap;
            margin-right: 8px;
        }

        .dict-sites-wrapper {
            display: flex;
            flex-wrap: wrap;
        }

        .dict-site-item {
            margin-right: 8px;
            white-space: nowrap;
        }
    </style>

    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet"
          type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.2.45/vue.global.min.js"></script>
</head>
<body>
<section id="app" class="container">
    <form @submit.prevent="doQuery" ref="dictForm" class="dict-form">
        <div class="dict-input-line">
            <label class="dict-input-box">
                <span class="dict-input-label-text">输入(<u>W</u>)</span>
                <input accesskey="w" autocomplete="words" autofocus placeholder="输入查询的单词" required
                       class="dict-input-field" v-model.trim="q">
            </label>

            <button accesskey="q" ref="submitBtn" class="dict-query-button" type="submit">查询(<u>Q</u>)</button>
        </div>

        <div class="dict-sites-line">
            <div class="dict-sites-label-text">选择网站(<u>S</u>)</div>
            <div class="dict-sites-wrapper">
                <label class="dict-site-item" v-for="(v, k) in links">
                    <input :title="k" :value="k" accesskey="s" name="dictSite" required type="radio"
                           v-model="currentQueryKey">
                    {{ k }}
                </label>
            </div>
            <!--<select :size="Object.keys(links).length" accesskey="s" required style="margin-left: 8px;"
                    v-model="currentQueryKey">
                <option :value="k" v-for="(v, k) in links">{{ k }}</option>
            </select>-->
        </div>

        <div style="margin-top: 16px;display: flex;justify-content: flex-end;font-size: smaller;">
            <label>
                <input type="checkbox" v-model="withSameTab">
                在相同标签页打开
            </label>
        </div>

        <a :href="currentQuery" :target="withSameTab ? 'dict' : currentQueryKey" hidden ref="queryLink"
           referrerpolicy="no-referrer"></a>
    </form>
</section>

<script>
    Vue.createApp({
        data: function () {
            return {
                links: {
                    '有道': query => `//dict.youdao.com/result?word=${query}&lang=en`,
                    '金山词霸': query => `//www.iciba.com/word?w=${query}`,
                    '剑桥': query => `//dictionary.cambridge.org/dictionary/english-chinese-simplified/${query}`,
                    '牛津': query => `//www.oxfordlearnersdictionaries.com/definition/english/${query}`,
                    '朗文': query => `//www.ldoceonline.com/dictionary/${query}`,
                },
                withSameTab: false,
                currentQueryKey: undefined,
                q: undefined,
            };
        },
        computed: {
            currentQuery() {
                return this.currentQueryKey && this.q && this.links[this.currentQueryKey](this.q);
            },
        },
        created() {
            this.currentQueryKey = Object.keys(this.links)[0];
        },
        methods: {
            doQuery() {
                this.$refs.queryLink.click();
                // window.open(this.currentQuery, this.currentQueryKey);
            }
        }
    }).mount('#app');
</script>
</body>
</html>
